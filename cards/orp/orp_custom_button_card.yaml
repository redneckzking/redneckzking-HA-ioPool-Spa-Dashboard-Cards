type: custom:button-card
entity: sensor.iopool_saluspa_bahama_orp
show_name: false
show_icon: false
show_state: false
show_label: false
tap_action:
  action: more-info
triggers_update:
  - sensor.iopool_saluspa_bahama_orp
custom_fields:
  row: |
    [[[
      const orp = Number(states['sensor.iopool_saluspa_bahama_orp']?.state);
      const ok = Number.isFinite(orp);

      let status = 'NO DATA',
          color = 'rgba(120,120,120,0.18)',
          border = 'rgba(120,120,120,0.35)',
          icon = 'mdi:help-circle-outline';

      if (ok) {
        if (orp < 550)        { status = 'LOW';       color='rgba(239,83,80,0.18)';   border='rgba(239,83,80,0.35)';   icon='mdi:alert-circle'; }
        else if (orp < 650)   { status = 'FAIR';      color='rgba(255,213,79,0.18)';  border='rgba(255,213,79,0.35)';  icon='mdi:beaker-alert'; }
        else if (orp <= 800)  { status = 'GOOD';      color='rgba(102,187,106,0.18)'; border='rgba(102,187,106,0.35)'; icon='mdi:check-decagram'; }
        else if (orp <= 1000) { status = 'HIGH';      color='rgba(255,213,79,0.18)';  border='rgba(255,213,79,0.35)';  icon='mdi:beaker-check'; }
        else                  { status = 'VERY HIGH'; color='rgba(239,83,80,0.18)';   border='rgba(239,83,80,0.35)';   icon='mdi:alert-octagon'; }
      }

      return `
        <div style="
          display:flex; align-items:center; justify-content:space-between;
          gap:10px; padding:10px 12px; border-radius:14px;
          background:${color}; border:1px solid ${border};
        ">
          <div style="display:flex; align-items:center; gap:10px;">
            <ha-icon icon="${icon}" style="width:18px; height:18px;"></ha-icon>
            <div style="text-align:left;">
              <div style="font-weight:700; font-size:13px; line-height:1.1; text-align:left;">ORP</div>
              <div style="font-size:11px; opacity:0.8; line-height:1.1; text-align:left;">${status}</div>
            </div>
          </div>
          <div style="font-weight:700; font-size:16px;">
            ${ok ? Math.round(orp)+' mV' : 'â€”'}
          </div>
        </div>
      `;
    ]]]
styles:
  card:
    - border-radius: 18px
    - padding: 6px
    - border: 1px solid rgba(255,255,255,0.10)
    - background: rgba(20,20,24,0.55)
    - box-shadow: 0 6px 18px rgba(0,0,0,0.18)
  grid:
    - grid-template-areas: "\"row\""
    - grid-template-columns: 1fr
    - grid-template-rows: min-content
  custom_fields:
    row:
      - width: 100%

